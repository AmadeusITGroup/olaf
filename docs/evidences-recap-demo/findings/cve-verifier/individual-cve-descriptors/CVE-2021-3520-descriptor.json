{
  "cve_id": "CVE-2021-3520",
  "library": "org.lz4:lz4-java",
  "affected_versions": [
    "< 1.8.0"
  ],
  "vulnerable_api": [
    "LZ4Compressor",
    "LZ4FastDecompressor",
    "LZ4SafeDecompressor",
    "LZ4Factory",
    "memmove operations"
  ],
  "cwe": [
    "CWE-787",
    "CWE-190"
  ],
  "cvss_score": 9.8,
  "severity": "Critical",
  "description": "There's a flaw in lz4. An attacker who submits a crafted file to an application linked with lz4 may be able to trigger an integer overflow, leading to calling of memmove() on a negative size argument, causing an out-of-bounds write and/or a crash. The greatest impact of this flaw is to availability, with some potential impact to confidentiality and integrity as well.",
  "remediation": "Upgrade to lz4 version 1.8.0 or higher. Apply vendor-specific patches: RHEL 8 - upgrade to lz4-libs 0:1.8.3-3.el8_4 or higher.",
  "fixed_version": "1.8.0",
  "publication_date": "2021-04-28",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2021-3520",
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3520",
    "https://bugzilla.redhat.com/show_bug.cgi?id=1954559",
    "https://linux.oracle.com/cve/CVE-2021-3520.html",
    "https://security.snyk.io/vuln/SNYK-RHEL8-LZ4LIBS-1484603",
    "https://www.oracle.com/security-alerts/cpujul2021.html",
    "https://www.oracle.com/security-alerts/cpuapr2022.html",
    "https://www.oracle.com/security-alerts/cpuoct2021.html",
    "https://access.redhat.com/errata/RHSA-2021:2575"
  ],
  "source_details": "CVE-2021-3520 affects lz4 compression library through integer overflow vulnerability. Research conducted from NIST NVD, MITRE CVE, RedHat Bugzilla, Oracle Linux CVE database, Snyk security advisory, and Oracle security alerts. Vulnerability allows crafted file input to trigger integer overflow in memmove() operations causing out-of-bounds write and potential system crash.",
  "discovery_instruction": {
    "import_patterns": [
      "import net.jpountz.lz4.*",
      "import org.lz4.*",
      "import net.jpountz.lz4.LZ4Compressor",
      "import net.jpountz.lz4.LZ4FastDecompressor",
      "import net.jpountz.lz4.LZ4SafeDecompressor",
      "import net.jpountz.lz4.LZ4Factory"
    ],
    "annotation_usage_patterns": [
      "@LZ4",
      "@Compress"
    ],
    "method_invocation_patterns": [
      "LZ4Factory.fastestInstance()",
      "LZ4Factory.nativeInstance()",
      "LZ4Factory.unsafeInstance()",
      "compressor.compress(",
      "decompressor.decompress(",
      "LZ4Compressor.compress(",
      "LZ4FastDecompressor.decompress(",
      "LZ4SafeDecompressor.decompress("
    ],
    "object_instantiation_patterns": [
      "new LZ4Compressor(",
      "new LZ4FastDecompressor(",
      "new LZ4SafeDecompressor(",
      "LZ4Factory.fastestInstance()",
      "LZ4Factory.nativeInstance()"
    ],
    "configuration_file_patterns": [
      "lz4-java",
      "org.lz4",
      "net.jpountz.lz4",
      "<groupId>org.lz4</groupId>",
      "<artifactId>lz4-java</artifactId>",
      "implementation 'org.lz4:lz4-java",
      "compile 'org.lz4:lz4-java"
    ],
    "dependency_declaration_patterns": [
      "<dependency>.*<groupId>org\\.lz4</groupId>.*<artifactId>lz4-java</artifactId>",
      "org\\.lz4:lz4-java:",
      "net\\.jpountz\\.lz4:lz4:",
      "lz4-java.*version.*[\"'].*[\"']"
    ],
    "framework_integration_patterns": [
      "LZ4BlockInputStream",
      "LZ4BlockOutputStream",
      "LZ4FrameInputStream",
      "LZ4FrameOutputStream",
      "compression.lz4",
      "codec.lz4"
    ]
  }
}
