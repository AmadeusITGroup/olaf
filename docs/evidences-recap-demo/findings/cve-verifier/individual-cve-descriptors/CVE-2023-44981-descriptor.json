{
  "cve_id": "CVE-2023-44981",
  "library": "org.apache.zookeeper:zookeeper",
  "affected_versions": [
    "< 3.7.2",
    "3.8.0 - 3.8.2",
    "3.9.0"
  ],
  "vulnerable_api": [
    "org.apache.zookeeper.server.quorum.QuorumPeer",
    "org.apache.zookeeper.server.quorum.auth.QuorumAuthServer",
    "SASL Quorum Peer Authentication",
    "QuorumCnxManager"
  ],
  "cwe": [
    "CWE-639"
  ],
  "cvss_score": 9.1,
  "severity": "Critical",
  "description": "Authorization Bypass Through User-Controlled Key vulnerability in Apache ZooKeeper. If SASL Quorum Peer authentication is enabled in ZooKeeper (quorum.auth.enableSasl=true), the authorization is done by verifying that the instance part in SASL authentication ID is listed in zoo.cfg server list. The instance part in SASL auth ID is optional and if it's missing, like 'eve@EXAMPLE.COM', the authorization check will be skipped. As a result an arbitrary endpoint could join the cluster and begin propagating counterfeit changes to the leader, essentially giving it complete read-write access to the data tree. Quorum Peer authentication is not enabled by default.",
  "remediation": "Users are recommended to upgrade to version 3.9.1, 3.8.3, 3.7.2, which fixes the issue. Alternately ensure the ensemble election/quorum communication is protected by a firewall as this will mitigate the issue. See the documentation for more details on correct cluster administration.",
  "fixed_version": "3.7.2, 3.8.3, 3.9.1",
  "publication_date": "2023-10-11",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-44981",
    "https://cve.org/CVERecord?id=CVE-2023-44981",
    "http://www.openwall.com/lists/oss-security/2023/10/11/4",
    "https://lists.apache.org/thread/wf0yrk84dg1942z1o74kd8nycg6pgm5b",
    "https://www.cvedetails.com/cve/CVE-2023-44981/",
    "https://security.netapp.com/advisory/ntap-20240621-0007/",
    "https://www.debian.org/security/2023/dsa-5544",
    "https://lists.debian.org/debian-lts-announce/2023/10/msg00029.html",
    "https://zookeeper.apache.org/doc/current/zookeeperAdmin.html"
  ],
  "source_details": "Research conducted from 8 authoritative sources: NIST NVD (CVSS 9.1 Critical, CWE-639), MITRE CVE, OpenWall Security Mailing List (Apache announcement by Andor Molnar), CVE Details (EPSS 0.03%), NetApp Security Advisory NTAP-20240621-0007, Debian Security Advisory DSA-5544-1, Apache ZooKeeper Administrator documentation, and original vulnerability report by Damien Diederen. All sources confirm this is a critical SASL authentication bypass vulnerability in ZooKeeper's quorum peer authentication mechanism affecting versions before 3.7.2, 3.8.0-3.8.2, and 3.9.0 when quorum.auth.enableSasl=true is configured.",
  "discovery_instruction": {
    "import_patterns": [
      "import org.apache.zookeeper.server.quorum.QuorumPeer",
      "import org.apache.zookeeper.server.quorum.auth.*",
      "import org.apache.zookeeper.server.quorum.*",
      "import org.apache.zookeeper.*",
      "org.apache.zookeeper.server.quorum.QuorumPeer",
      "org.apache.zookeeper.server.quorum.auth.QuorumAuthServer"
    ],
    "annotation_usage_patterns": [],
    "method_invocation_patterns": [
      "QuorumPeer.start()",
      "QuorumPeer.setQuorumSaslEnabled",
      "QuorumAuthServer.authenticate",
      "QuorumCnxManager.authenticateConnection"
    ],
    "object_instantiation_patterns": [
      "new QuorumPeer(",
      "new QuorumAuthServer(",
      "new QuorumCnxManager("
    ],
    "configuration_file_patterns": [
      "quorum.auth.enableSasl=true",
      "quorum.auth.enableSasl",
      "zoo.cfg",
      "zookeeper.properties",
      "quorum.auth.learner.*",
      "quorum.auth.server.*",
      "authProvider.*=.*SASL.*"
    ],
    "dependency_declaration_patterns": [
      "org.apache.zookeeper:zookeeper:3.4.*",
      "org.apache.zookeeper:zookeeper:3.5.*",
      "org.apache.zookeeper:zookeeper:3.6.*",
      "org.apache.zookeeper:zookeeper:3.7.0",
      "org.apache.zookeeper:zookeeper:3.7.1",
      "org.apache.zookeeper:zookeeper:3.8.0",
      "org.apache.zookeeper:zookeeper:3.8.1",
      "org.apache.zookeeper:zookeeper:3.8.2",
      "org.apache.zookeeper:zookeeper:3.9.0",
      "zookeeper-[3-9]\\..*\\.jar",
      "zookeeper-3\\.[4-9]\\.",
      "<artifactId>zookeeper</artifactId>"
    ],
    "framework_integration_patterns": [
      "QuorumPeerConfig.*enableSasl",
      "SaslQuorumAuthLearner",
      "SaslQuorumAuthServer",
      "QuorumAuth.*SASL",
      "SASL.*Quorum.*Auth"
    ]
  }
}
