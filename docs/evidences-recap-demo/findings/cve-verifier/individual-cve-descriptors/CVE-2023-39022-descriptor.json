{
  "cve_id": "CVE-2023-39022",
  "library": "opensymphony:oscore",
  "affected_versions": ["2.2.6", "2.2.5", "2.2.4", "2.2.3", "2.2.2", "2.2.1", "2.2.0", "2.1.x", "2.0.x", "1.x"],
  "vulnerable_api": [
    "com.opensymphony.util.EJBUtils.createStateless"
  ],
  "cwe": ["CWE-94"],
  "cvss_score": 9.8,
  "severity": "Critical",
  "description": "oscore v2.2.6 and below contains a code injection vulnerability in the component com.opensymphony.util.EJBUtils.createStateless. This vulnerability is exploited via passing an unchecked argument, allowing attackers to execute arbitrary commands through LDAP injection vectors.",
  "remediation": "Upgrade to oscore version 2.2.7 or later. If upgrade is not possible, avoid using EJBUtils.createStateless with untrusted input or implement proper input validation and sanitization.",
  "fixed_version": "2.2.7",
  "publication_date": "2023-08-03",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-39022",
    "https://github.com/advisories/GHSA-859m-2pfx-fwhf",
    "https://github.com/LetianYuan/My-CVE-Public-References/tree/main/opensymphony_oscore",
    "https://www.cvedetails.com/cve/CVE-2023-39022/",
    "https://github.com/jeremylong/DependencyCheck/issues/5858"
  ],
  "source_details": "NIST NVD: oscore v2.2.6 and below was discovered to contain a code injection vulnerability in the component com.opensymphony.util.EJBUtils.createStateless. This vulnerability is exploited via passing an unchecked argument. CVSS Vector: AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "discovery_instruction": {
    "import_patterns": [
      "com.opensymphony.util.EJBUtils",
      "import com.opensymphony.util.*"
    ],
    "annotation_usage_patterns": [],
    "method_invocation_patterns": [
      "EJBUtils.createStateless",
      ".createStateless("
    ],
    "object_instantiation_patterns": [],
    "configuration_file_patterns": [],
    "dependency_declaration_patterns": [
      "opensymphony:oscore:2.2.6",
      "opensymphony:oscore:2.2.5",
      "opensymphony:oscore:2.2.4",
      "opensymphony:oscore:2.2.3",
      "opensymphony:oscore:2.2.2",
      "opensymphony:oscore:2.2.1",
      "opensymphony:oscore:2.2.0",
      "opensymphony:oscore:2.1",
      "opensymphony:oscore:2.0",
      "opensymphony:oscore:1",
      "<groupId>opensymphony</groupId>\\s*<artifactId>oscore</artifactId>\\s*<version>2\\.2\\.[0-6]",
      "<groupId>opensymphony</groupId>\\s*<artifactId>oscore</artifactId>\\s*<version>[12]\\."
    ],
    "framework_integration_patterns": [
      "EJBUtils",
      "createStateless"
    ]
  }
}
