{
  "cve_id": "CVE-2024-38821",
  "library": "org.springframework.security:spring-security-web",
  "affected_versions": [
    "5.7.0 - 5.7.12",
    "5.8.0 - 5.8.14",
    "6.0.0 - 6.0.12",
    "6.1.0 - 6.1.10",
    "6.2.0 - 6.2.6",
    "6.3.0 - 6.3.3"
  ],
  "vulnerable_api": [],
  "cwe": [
    "CWE-770"
  ],
  "cvss_score": 9.1,
  "severity": "Critical",
  "description": "Spring WebFlux applications that have Spring Security authorization rules on static resources can be bypassed under certain circumstances. For this to impact an application, all of the following must be true: It must be a WebFlux application, it must be using Spring's static resources support, and it must have a non-permitAll authorization rule applied to the static resources support.",
  "remediation": "Users of affected versions should upgrade to the corresponding fixed version.",
  "fixed_version": "5.7.13, 5.8.15, 6.0.13, 6.1.11, 6.2.7, 6.3.4",
  "publication_date": "2024-10-28",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-38821",
    "https://spring.io/security/cve-2024-38821",
    "https://security.netapp.com/advisory/ntap-20250124-0006/",
    "https://www.herodevs.com/vulnerability-directory/cve-2024-38821",
    "https://tuxcare.com/blog/cve-2024-38821-spring-security-patch-update-how-tuxcare-users-are-protected/",
    "http://cwe.mitre.org/data/definitions/770.html"
  ],
  "source_details": "New CVE Received from VMware 10/28/2024 3:15:07 AM",
  "discovery_instruction": {
    "import_patterns": [
      "org.springframework.web.reactive",
      "org.springframework.security.config.web.server"
    ],
    "annotation_usage_patterns": [
      "@EnableWebFluxSecurity"
    ],
    "method_invocation_patterns": [
      "http.authorizeExchange()",
      "pathMatchers(\"/static/**\")",
      "hasRole"
    ],
    "object_instantiation_patterns": [],
    "configuration_file_patterns": [
      "spring.webflux.static-path-pattern"
    ],
    "dependency_declaration_patterns": [
      "spring-boot-starter-webflux",
      "spring-boot-starter-security"
    ],
    "framework_integration_patterns": [
      "ServerHttpSecurity"
    ]
  }
}
