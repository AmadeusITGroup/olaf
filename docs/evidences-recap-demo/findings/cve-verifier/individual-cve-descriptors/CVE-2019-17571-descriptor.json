{
  "cve_id": "CVE-2019-17571",
  "library": "log4j:log4j",
  "affected_versions": ["1.2", "1.2.1", "1.2.2", "1.2.3", "1.2.4", "1.2.5", "1.2.6", "1.2.7", "1.2.8", "1.2.9", "1.2.10", "1.2.11", "1.2.12", "1.2.13", "1.2.14", "1.2.15", "1.2.16", "1.2.17"],
  "vulnerable_api": [
    "org.apache.log4j.net.SocketServer",
    "org.apache.log4j.net.SocketServer.main",
    "org.apache.log4j.net.SocketServer.run",
    "org.apache.log4j.spi.LoggingEvent"
  ],
  "cwe": ["CWE-502"],
  "cvss_score": 9.8,
  "severity": "Critical",
  "description": "Included in Log4j 1.2 is a SocketServer class that is vulnerable to deserialization of untrusted data which can be exploited to remotely execute arbitrary code when combined with a deserialization gadget when listening to untrusted network traffic for log data. This affects Log4j versions up to 1.2 up to 1.2.17.",
  "remediation": "Upgrade to Apache Log4j 2.x (org.apache.logging.log4j:log4j-core). Log4j 1.x is end-of-life and no security patches are available. Remove or disable SocketServer usage if upgrade is not immediately possible.",
  "fixed_version": null,
  "publication_date": "2019-12-20",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2019-17571",
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17571",
    "https://github.com/advisories/GHSA-2qrg-x229-3v8q",
    "https://lists.apache.org/thread.html/eea03d504b36e8f870e8321d908e1def1addda16adda04327fe7c125@%3Cdev.logging.apache.org%3E",
    "https://security.netapp.com/advisory/ntap-20200110-0001/",
    "https://www.debian.org/security/2020/dsa-4686",
    "https://www.oracle.com/security-alerts/cpuapr2020.html",
    "https://usn.ubuntu.com/4495-1/"
  ],
  "source_details": "Research conducted from 8 authoritative sources: NIST NVD, MITRE CVE, GitHub Security Advisory GHSA-2qrg-x229-3v8q, Apache Logging mailing list, NetApp Security Advisory, Debian Security Advisory DSA-4686-1, Oracle Critical Patch Update April 2020, and Ubuntu Security Notice 4495-1. All sources confirm this is a critical deserialization vulnerability in Log4j 1.2's SocketServer class affecting all versions up to 1.2.17.",
  "discovery_instruction": {
    "import_patterns": [
      "import org.apache.log4j.net.SocketServer",
      "import org.apache.log4j.net.*",
      "import org.apache.log4j.*",
      "org.apache.log4j.net.SocketServer"
    ],
    "annotation_usage_patterns": [
      "@Log4j",
      "@Slf4j.*log4j.*"
    ],
    "method_invocation_patterns": [
      "SocketServer.main(",
      "SocketServer.run(",
      "new SocketServer(",
      "SocketServer.*listen",
      "SocketServer.*start",
      "LoggingEvent.*readExternal",
      "ObjectInputStream.*readObject.*LoggingEvent"
    ],
    "object_instantiation_patterns": [
      "new SocketServer(",
      "new LoggingEvent(",
      "SocketServer.class.newInstance(",
      "Class.forName.*SocketServer.*newInstance"
    ],
    "configuration_file_patterns": [
      "log4j.properties",
      "log4j.xml",
      "log4j.configuration",
      "log4j.appender.*SocketServer",
      "SocketServer.*port",
      "log4j.net.SocketServer"
    ],
    "dependency_declaration_patterns": [
      "log4j:log4j:1.",
      "groupId>log4j</groupId>.*<artifactId>log4j</artifactId>.*<version>1\\.",
      "org.apache.log4j.*1\\.",
      "'log4j:log4j:1.",
      "\"log4j:log4j:1.",
      "log4j.*version.*1\\."
    ],
    "framework_integration_patterns": [
      "spring.*log4j.*1\\.",
      "logback.*log4j.*bridge",
      "slf4j.*log4j12",
      "commons-logging.*log4j.*1\\.",
      "weblogic.*log4j.*1\\.",
      "tomcat.*log4j.*1\\.",
      "jboss.*log4j.*1\\."
    ]
  }
}
