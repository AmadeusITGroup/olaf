{
  "type": "object",
  "properties": {
    "cve_id": {
      "type": "string",
      "pattern": "^CVE-\\d{4}-\\d{4,}$",
      "description": "CVE identifier"
    },
    "library": {
      "type": "string",
      "description": "Library in groupId:artifactId format"
    },
    "affected_versions": {
      "type": "array",
      "items": { "type": "string" },
      "description": "List of affected library versions"
    },
    "vulnerable_api": {
      "type": "array",
      "items": { "type": "string" },
      "description": "List of vulnerable API classes/methods"
    },
    "cwe": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Common Weakness Enumeration identifiers"
    },
    "cvss_score": {
      "type": ["number", "null"],
      "minimum": 0,
      "maximum": 10,
      "description": "CVSS vulnerability score"
    },
    "severity": {
      "type": "string",
      "enum": ["Critical", "High", "Medium", "Low"],
      "description": "Vulnerability severity level"
    },
    "description": {
      "type": "string",
      "description": "Vulnerability description"
    },
    "remediation": {
      "type": ["string", "null"],
      "description": "Remediation advice"
    },
    "fixed_version": {
      "type": ["string", "null"],
      "description": "Version where vulnerability is fixed"
    },
    "publication_date": {
      "type": "string",
      "description": "CVE publication date"
    },
    "references": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Reference URLs and patches"
    },
    "source_details": {
      "type": "string",
      "description": "Original details from source data"
    },
    "discovery_instruction": {
      "type": "object",
      "properties": {
        "import_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Import statement patterns to search for"
        },
        "annotation_usage_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Annotation usage patterns"
        },
        "method_invocation_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Method invocation patterns"
        },
        "object_instantiation_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Object instantiation patterns"
        },
        "configuration_file_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Configuration file patterns"
        },
        "dependency_declaration_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Dependency declaration patterns"
        },
        "framework_integration_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Framework integration patterns"
        }
      },
      "required": ["import_patterns", "method_invocation_patterns", "dependency_declaration_patterns"],
      "description": "Code discovery instructions for pattern matching analysis"
    }
  },
  "required": ["cve_id", "library", "severity", "description", "discovery_instruction"],
  "additionalProperties": false,
  "description": "Schema for individual CVE descriptor files containing complete vulnerability information, NIST enrichment data, and code discovery instructions."
}
