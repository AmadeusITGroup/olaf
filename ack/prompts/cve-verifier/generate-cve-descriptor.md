---
name: generate-cve-descriptor
description: Create comprehensive CVE descriptor file with multi-source research and discovery patterns
tags: [cve, security, descriptor, vulnerability, cve-verifier]
---

## Input Parameters
- **cve_id**: string - CVE identifier (format: CVE-YYYY-NNNNN)
- **blackduck_csv_path**: string - Path to BlackDuck CSV file for dependency validation
- **output_directory**: string - Directory to save the CVE descriptor file

## Previous Steps or Phase
1. CVE tasklist has been generated identifying CVEs requiring descriptors
2. BlackDuck CSV data is available for dependency validation
3. Output directory structure exists for CVE descriptor files
4. Next priority CVE has been identified from the tasklist

## Process

1. **Update Descriptor Tasklist** (MANDATORY FIRST STEP):
   - Execute script: `[id:tools_dir]/cve-verifier/update-tasklist.ps1` with parameters:
     - `-Tasklist_type "Descriptor"`
     - `-Blackduck_CSV` set to blackduck_csv_path
   - Review updated tasklist to identify next priority CVE requiring descriptor
   - Verify CVE from tasklist matches cve_id parameter

2. **Validate CVE and Dependencies**:
   - Verify CVE format matches CVE-YYYY-NNNNN pattern
   - Check if descriptor already exists at `{output_directory}/individual-cve-descriptors/{cve_id}-descriptor.json`
   - Cross-reference CVE with BlackDuck CSV to validate dependency presence
   - Skip if descriptor exists, proceed if missing

3. **Comprehensive Multi-Source Research** (MANDATORY - NO SHORTCUTS):
   - **Primary Sources** (REQUIRED):
     - NIST NVD: CVE description, CVSS, affected versions, remediation
     - MITRE CVE: Original CVE record for additional context
   - **All Referenced Sources** (MANDATORY):
     - Fetch content from EVERY reference URL listed in NIST findings
     - Extract technical details not available in NIST
     - Document vendor statements and official patches
     - Capture exploitation examples and proof of concepts
   - **Enhanced Context Sources** (REQUIRED):
     - Snyk/GitHub Security Advisories
     - Vendor security bulletins
     - Security researcher analysis
     - CVE database services (VulnDB, CVE Details)
   - **VERIFICATION**: Must document minimum 6 authoritative sources per descriptor

4. **Create CVE Descriptor File**:
   - Use template: `[id:templates_dir]/cve-verifier/cve-descriptor-schema.json`
   - Populate all required fields with researched information
   - Include **TARGETED** discovery patterns for code analysis (CRITICAL GUIDELINES):
     - **VULNERABILITY-SPECIFIC ONLY**: Patterns must be directly related to the specific CVE vulnerability mechanism
     - **NO GENERIC TERMS**: Avoid generic framework annotations, validation patterns, or common library terms
     - **FOCUS ON ROOT CAUSE**: Include only patterns that indicate the vulnerable component/functionality
     
     **Pattern Categories** (Keep minimal and targeted):
     - `import_patterns`: Specific vulnerable classes/packages ONLY (not entire frameworks)
     - `method_invocation_patterns`: Exact vulnerable method calls and parameters
     - `configuration_file_patterns`: Specific vulnerable configuration settings
     - `dependency_declaration_patterns`: Exact vulnerable artifact/version patterns
     - `framework_integration_patterns`: Vulnerability-specific usage patterns ONLY
     
     **EXAMPLES OF WHAT TO AVOID**:
     - Generic JAX-RS annotations (@Path, @GET, @POST, etc.)
     - Common validation annotations (@Valid, @NotNull, @Size, etc.)
     - Generic framework classes (Response, Context, Provider, etc.)
     - Common dependency names without version specificity
     - Broad framework terms ("REST", "API", "web service")
     
     **EXAMPLES OF GOOD PATTERNS**:
     - Specific vulnerable class names (e.g., "WadlGenerator", "styleSheetPath")
     - Exact vulnerable method signatures
     - Specific configuration parameters that trigger the vulnerability
     - Precise artifact names of vulnerable modules
     - Unique identifiers of the vulnerable functionality
   - Save as: `{output_directory}/individual-cve-descriptors/{cve_id}-descriptor.json`

5. **Update Global CVE Index**:
   - Use template: `[id:templates_dir]/cve-verifier/global-cve-index-template.json`
   - Load existing `{output_directory}/global-cve-index.json` if exists
   - Add new entry with only CVE ID and descriptor file path (simplified format)
   - Structure: `"CVE-ID": {"descriptor_file": "individual-cve-descriptors/CVE-ID-descriptor.json"}`
   - Save updated global index for future reference

6. **Session Management and Progress Update**:
   - Execute automated progress update: `[id:tools_dir]/cve-verifier/update-tasklist.ps1` with parameters:
     - `-Tasklist_type "Descriptor"`
     - `-Blackduck_CSV` set to blackduck_csv_path
   - Verify descriptor creation completed successfully
   - Update tasklist to reflect completion status

## Output Format
- CVE descriptor file: `{output_directory}/individual-cve-descriptors/{cve_id}-descriptor.json`
- Updated global index: `{output_directory}/global-cve-index.json`
- Updated tasklist showing completion progress

## Output to USER
- Confirmation message: "CVE descriptor created successfully for {cve_id}"
- Descriptor file location with validation status
- Research sources count and quality verification
- Next phase: **MANDATORY SESSION HANDOFF**

### ‚úÖ CVE Descriptor Creation Complete - Session Handoff

**Completed CVE**: {cve_id}
- **Location**: `{output_directory}/individual-cve-descriptors/{cve_id}-descriptor.json`
- **Research Sources**: 6+ authoritative sources verified
- **Next Priority**: [Show next CVE from updated tasklist]

### üîÑ To Continue Workflow - Follow These Exact Steps:
1. **Start New Session** with the agent
2. **Ask**: `"cve exposure"`
3. The agent will continue with Step 2 (LLMs Create) and Step 3 (CVE Analysis)

**‚ö†Ô∏è Session must end here. Please start a new session and ask "cve exposure" to continue.**

## CVE-Verifier Domain Rules
- Rule 1: Each descriptor MUST contain information from minimum 6 authoritative sources
- Rule 2: ALL reference URLs from NIST findings must be researched and documented
- Rule 3: Discovery patterns must be comprehensive for all vulnerability types
- Rule 4: Mandatory session handoff after each CVE completion - no continuing to next CVE
- Rule 5: Progress update script must be executed after each completion
